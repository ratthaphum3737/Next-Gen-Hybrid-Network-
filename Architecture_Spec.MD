# ข้อกำหนดสถาปัตยกรรมระบบ (Architecture Specification)

## 1.1 ภาพรวมของสถาปัตยกรรมระบบ (System Architectural Overview)
สถาปัตยกรรมของ IDMS ถูกออกแบบโดยละทิ้งการสื่อสารแบบชี้เฉพาะจุด (Point-to-Point) ที่เป็นมาตรฐานเดิม และเปลี่ยนผ่านไปสู่การทำงานแบบกระจายศูนย์ (Decentralized Mesh) ระบบจะประกอบด้วยโหนดรับส่งข้อมูลจำลองที่ทำงานร่วมกันแบบ Asynchronous เพื่อให้สามารถหาเส้นทาง (Routing) ทางเลือกได้อัตโนมัติเมื่อเกิดสภาวะที่ช่องสัญญาณหลักถูกตัดขาด

## 1.2 โครงสร้างโหนดเครือข่าย (Network Node Architecture)
ระบบจำลองประกอบด้วยโหนดหลัก 4 ประเภท ซึ่งโต้ตอบกันในระดับ Network Layer ดังนี้

| ชื่อโหนด | บทบาทในระบบ |
|---------|-------------|
| Earth Mission Control (EMC) | โหนดศูนย์กลางบนโลก ส่งคำสั่ง Telemetry และรับข้อมูลผล |
| Lunar Gateway Relay (LGR) | โหนดดาวเทียมถ่ายทอดสัญญาณ ทำหน้าที่เป็น Router กลางทาง |
| Surface Base LAN (SBL) | เครือข่าย Local ภายในฐานบนดวงจันทร์ ใช้ Ethernet Switching |
| Deep Space Probe (DSP) | ยานสำรวจอวกาศลึก มีโอกาสสูญเสียสัญญาณสูงที่สุด |

## 1.3 สถาปัตยกรรมระดับ Physical และ Data Link Layer
เพื่อรองรับความเสถียรสูงสุด ระบบจำลองอ้างอิงการทำงานแบบ Hybrid Failover Mechanism โดยแบ่งช่องสัญญาณออกเป็น 2 ประเภท:

- **Primary Link (Optical/Laser):**  
  จำลองช่องสัญญาณแบนด์วิดท์สูงสำหรับส่งข้อมูลขนาดใหญ่ เช่น วิดีโอ 4K และภาพถ่ายวิทยาศาสตร์ อ้างอิงจากระบบ O2O ในภารกิจ Artemis II ที่รองรับความเร็วสูงสุด 260 Mbps

- **Secondary/Fallback Link (Radio Frequency):**  
  จำลองช่องสัญญาณสำรองที่จะถูกเรียกใช้งานโดยอัตโนมัติในระดับ Data Link Layer เมื่อระบบตรวจพบว่าลิงก์ Optical ถูกบดบังหรือมีค่า Error Rate เกินเกณฑ์

## 1.4 สถาปัตยกรรมโปรโตคอล DTN (Delay/Disruption Tolerant Networking)
เนื่องจากโปรโตคอล TCP/IP มาตรฐานไม่สามารถทำงานได้อย่างมีประสิทธิภาพในสภาวะที่ Latency สูง (เกิดการ Timeout บ่อยครั้ง) สถาปัตยกรรมนี้จึงนำ Bundle Protocol มาใช้งาน ซึ่งมีกลไกสำคัญ 2 ประการ:

- **Store-and-Forward Mechanism:**  
  โหนดในระบบจะไม่ทำการดรอปแพ็กเก็ตทันทีที่การเชื่อมต่อล้มเหลว แต่จะเก็บ Bundle ไว้ใน Persistent Storage Buffer และทำการ Forward เมื่อเส้นทางไปยัง Next-Hop เปิดใช้งานอีกครั้ง

- **Custody Transfer:**  
  ระบบมีการรับมอบสิทธิ์ความเป็นเจ้าของแพ็กเก็ต เพื่อรับประกันว่าจะมีโหนดรับผิดชอบข้อมูลนั้นเสมอจนกว่าจะถึงปลายทาง

## 1.5 ระบบ Quality of Service (QoS) และการจัดการคิว
สถาปัตยกรรมกำหนดกฎเกณฑ์การจัดการคิวข้อมูล (Queue Management) โดยแบ่งลำดับความสำคัญเป็น 3 ระดับ:

| Priority | ประเภทข้อมูล | นโยบายการจัดการ |
|---------|--------------|------------------|
| 1 — Critical | Telemetry, คำสั่งฉุกเฉิน | Bypass คิว ส่งออกก่อนทันที ไม่มีการ Drop |
| 2 — Scientific | ภาพถ่าย, ข้อมูลวิทยาศาสตร์ | Store-and-Forward รอแบนด์วิดท์ว่าง |
| 3 — Media | วิดีโอสตรีมมิ่ง, ไฟล์ทั่วไป | สามารถลด Bitrate หรือ Drop ได้หากทรัพยากรวิกฤต |